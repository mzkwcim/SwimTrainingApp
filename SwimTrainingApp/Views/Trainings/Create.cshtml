<h2>Create Training</h2>

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<form asp-action="Create" method="post">
    <div class="form-group">
        <label asp-for="Date">Training Date</label>
        <input asp-for="Date" type="datetime-local" class="form-control" />
    </div>

    <h3>Tasks</h3>
    <div id="tasks-container">
        @for (int i = 0; i < 20; i++)
        {
            <div class="task-item" style="display: @(i == 0 ? "block" : "none");" data-index="@i">
                <h4>Task @(i + 1)</h4>
                <div class="row">
                    <div class="col-md-3">
                        <div class="form-group">
                            <label>Section</label>
                            <input type="text" name="Tasks[@i].TrainingSection" class="form-control" />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label>Description</label>
                            <input type="text" name="Tasks[@i].TaskDescription" class="form-control" />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label>Distance</label>
                            <input type="number" name="Tasks[@i].Distance" class="form-control" />
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label>Task Type</label>
                            <select name="Tasks[@i].TaskType" class="form-control">
                                <option value="NN">NN</option>
                                <option value="RR">RR</option>
                                <option value="ANC">ANC</option>
                                <option value="ANP">ANP</option>
                                <option value="AEC1">AEC1</option>
                                <option value="AEC2">AEC2</option>
                            </select>
                        </div>
                    </div>
                </div>
                <hr />
            </div>
        }
    </div>

    <button type="button" id="add-task-btn" class="btn btn-primary">Add Task</button>
    <br /><br />
    <button type="submit" class="btn btn-success">Create Training</button>
</form>

@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            console.log("JS działa!"); // Test konsoli

            // Dodawanie obsługi kliknięcia dla przycisku
            const addTaskBtn = document.getElementById("add-task-btn");
            addTaskBtn.addEventListener("click", function () {
                console.log("Przycisk Add Task został kliknięty.");
                const tasks = document.querySelectorAll(".task-item");
                for (let i = 0; i < tasks.length; i++) {
                    if (tasks[i].style.display === "none") {
                        tasks[i].style.display = "block"; // Pokazuje pierwszy ukryty formularz
                        break; // Zatrzymuje po znalezieniu pierwszego ukrytego
                    }
                }
            });
        });
    </script>
}
